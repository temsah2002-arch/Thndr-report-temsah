<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Thndr â€” Dashboard</title>

  <!-- Ø§Ù„Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ù…ÙˆØ­Ø¯ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ -->
  <link rel="stylesheet" href="assets/ui.css">

  <style>
    :root{
      --bg:#0b0b0f;--card:#14141b;--soft:#0f1016;--border:#23242c;
      --txt:#f3f4f6;--muted:#a1a1aa;--acc:#0ea5e9;--good:#22c55e;--bad:#ef4444
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--txt);font-family:"Cairo",Tahoma,Arial,sans-serif}
    .container{max-width:1200px;margin:22px auto;padding:0 16px}
    .grid{display:grid;gap:12px}
    .two{grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}
    .small{color:var(--muted);font-size:12px}
    .pos{color:var(--good);font-weight:700}
    .neg{color:var(--bad);font-weight:700}
    .card--noPad{padding:0}
    .mt-8{margin-top:8px}
    .mt-12{margin-top:12px}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .kpi{display:flex;justify-content:space-between;align-items:center;background:var(--soft);border:1px solid var(--border);border-radius:14px;padding:12px}
    .kpi b{font-size:18px}
    .table{width:100%;border-collapse:collapse;background:var(--soft);border:1px solid var(--border);border-radius:12px;overflow:hidden}
    .table th,.table td{padding:10px;border-bottom:1px solid var(--border);text-align:right;font-size:14px}
    .table th{background:#101118;color:#cbd5e1}

    /* === Modal === */
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;z-index:999}
    .modal{position:fixed;inset:0;display:none;place-items:center;z-index:1000}
    .modal .box{width:min(560px,94vw);background:#14141b;border:1px solid #23242c;border-radius:16px;padding:16px}
    .modal .row{display:flex;gap:8px;flex-wrap:wrap}
    .modal label{display:block;font-size:12px;color:#a1a1aa;margin:8px 0 4px}
    .modal input, .modal textarea{
      width:100%;background:#0f1016;border:1px solid #23242c;border-radius:10px;color:#fff;padding:10px;font-family:inherit
    }
    .modal .actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
    .modal.show, .modal-backdrop.show{display:grid}
  </style>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://s3.tradingview.com/tv.js"></script>
</head>
<body>
  <div class="container">
    <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
    <div class="header">
      <div class="title">Ù„ÙˆØ­Ø© Ø«Ø§Ù†Ø¯Ø± â€” Dashboard</div>
      <div id="date" class="chip">â€”</div>
      <div class="toolbar">
        <a class="btn" href="report/portfolio_report.html">ğŸ“Š Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</a>
        <a class="btn" href="plan/">ğŸ’° Ø®Ø·Ø© Ø¥ÙŠØ¯Ø§Ø¹ 24</a>
        <a class="btn btn--soft" href="report/#CALC">ğŸ§® Ø­Ø§Ø³Ø¨Ø© ØªØ¯Ø§ÙˆÙ„</a>
      </div>
    </div>

    <!-- Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„: Ù…Ù„Ø®Øµ + ØªÙˆØ²ÙŠØ¹ -->
    <div class="grid two">

      <!-- ÙƒØ§Ø±Øª Ø§Ù„Ù…Ù„Ø®Øµ ÙˆØ´Ø±ÙŠØ· Ø§Ù„Ø³ÙˆÙ‚ -->
      <div class="card">
        <div class="grid two" id="stats"></div>

        <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø­ÙŠ -->
        <div class="row mt-8">
          <span class="chip">EGX30: <b id="egx30_val">â€”</b></span>
          <span class="chip">EGX70: <b id="egx70_val">â€”</b></span>
          <span class="chip">Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±: <b id="usd_val">â€”</b></span>
        </div>

        <!-- Ø±ÙˆØ§Ø¨Ø· Ø³Ø±ÙŠØ¹Ø© + Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ« -->
        <div class="row mt-8">
          <a class="btn" href="report/">Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</a>
          <a class="btn" href="plan/">Ø®Ø·Ø© Ø¥ÙŠØ¯Ø§Ø¹ 24</a>
          <a class="btn btn--soft" href="report/analysis.html">ğŸ“ˆ ØªØ­Ù„ÙŠÙ„ ÙˆØªÙˆØµÙŠØ§Øª</a>
          <a class="btn btn--soft" href="report/#CALC">Ø­Ø§Ø³Ø¨Ø© ØªØ¯Ø§ÙˆÙ„</a>
          <a class="btn" href="report/analyzer.html">ğŸ§­ Ù…Ø­Ù„Ù„ Ø§Ù„ØªØ¯Ø§ÙˆÙ„</a>

          <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© -->
          <button class="btn btn--soft" id="btnEdit">âœï¸ ØªØ­Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…</button>
          <button class="btn" id="btnUpdate">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙŠÙˆÙ…</button>
          <button class="btn btn--soft" id="btnToken">ğŸ” Ø¶Ø¨Ø· GitHub Token</button>
        </div>
      </div> <!-- Ø¥ØºÙ„Ø§Ù‚ ÙƒØ§Ø±Øª Ø§Ù„Ù…Ù„Ø®Øµ -->

      <!-- ÙƒØ§Ø±Øª ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø­ÙØ¸Ø© -->
      <div class="card">
        <div class="small" style="font-weight:700;margin-bottom:6px">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø­ÙØ¸Ø©</div>
        <canvas id="alloc" height="280"></canvas>
        <div id="allocLegend" class="small" style="margin-top:6px"></div>
      </div>

    </div> <!-- Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ -->

    <!-- ÙƒØ§Ø±Øª EGX30 Ø§Ù„Ù…Ø¨Ø§Ø´Ø± -->
    <div class="card">
      <div class="small" style="font-weight:700;margin-bottom:6px">EGX30 â€” Ù…Ø¨Ø§Ø´Ø±</div>
      <div id="egx" style="height:380px"></div>
      <div class="small">Ø¥Ù† Ù„Ù… ÙŠØ¸Ù‡Ø± Ø§Ù„Ø±Ø³Ù… Ø¬Ø±Ù‘Ø¨ Ø´Ø¨ÙƒØ© Ø£Ø®Ø±Ù‰ Ø£Ùˆ Ø§ÙØªØ­Ù‡ Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­ Ù…Ø¨Ø§Ø´Ø±Ø©.</div>
    </div>

    <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±Ø§ÙƒØ² -->
    <div class="card card--noPad mt-12">
      <table class="table" id="pos">
        <thead>
          <tr>
            <th>Ø§Ù„Ø³Ù‡Ù…</th>
            <th>Ø§Ù„ÙˆØ­Ø¯Ø§Øª</th>
            <th>Ù…ØªÙˆØ³Ø·</th>
            <th>Ø¢Ø®Ø±</th>
            <th>Ø§Ù„Ù‚ÙŠÙ…Ø©</th>
            <th>Ø§Ù„Ø±Ø¨Ø­/Ø§Ù„Ø®Ø³Ø§Ø±Ø©</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

  </div> <!-- Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø­Ø§ÙˆÙŠØ© -->

  <!-- Ø³ÙƒØ±Ø¨Øª Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
  <script>
    const fmt = (n,d=2)=> new Intl.NumberFormat('ar-EG',{maximumFractionDigits:d}).format(+n||0);
    const pct = n => ((n>=0?'+':'') + (Number(n)||0).toFixed(2) + '%');
    const REFRESH_MS = 5*60*1000; // ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚

    async function renderAll(){
      const p = await fetch('data/portfolio.json?_=' + Date.now()).then(r=>r.json());
      document.getElementById('date').textContent =
        new Date(p.as_of||Date.now()).toLocaleDateString('ar-EG',{day:'numeric',month:'long',year:'numeric'});

      // Ø§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø§Ù„Ø¹Ù„ÙˆÙŠØ©
      document.getElementById('stats').innerHTML = `
        <div class="kpi"><span>Ù‚ÙŠÙ…Ø© Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ</span><b id="pf_value">${fmt(p.portfolio_value)}</b></div>
        <div class="kpi"><span>ØªØºÙŠØ± Ø§Ù„ÙŠÙˆÙ…</span>
          <b id="pf_day" class="${p.day_change>=0?'pos':'neg'}">
            ${fmt(p.day_change)} (${pct(p.day_change_pct)})
          </b>
        </div>`;

      // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±Ø§ÙƒØ²
      const tb = document.querySelector('#pos tbody');
      tb.innerHTML = (p.positions||[]).map(x=>`
        <tr>
          <td><b>${x.ticker}</b> â€” <span class="small">${x.name||''}</span></td>
          <td>${fmt(x.units,0)}</td>
          <td>${fmt(x.avg_price)}</td>
          <td>${fmt(x.last)}</td>
          <td>${fmt(x.market_value)}</td>
          <td class="${x.pnl>=0?'pos':'neg'}">${fmt(x.pnl)} (${pct(x.pnl_pct)})</td>
        </tr>`).join('');

      // ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø­ÙØ¸Ø©
      const labels = (p.positions||[]).map(x=>x.ticker);
      const data   = (p.positions||[]).map(x=>+x.market_value||0);
      const total  = data.reduce((a,b)=>a+b,0)||1;
      const per    = data.map(v=> v/total*100);

      if(window.allocChart) window.allocChart.destroy();
      window.allocChart = new Chart(document.getElementById('alloc').getContext('2d'),{
        type:'doughnut',
        data:{labels, datasets:[{data, borderWidth:0}]},
        options:{plugins:{legend:{display:false}}, cutout:'60%'}
      });
      document.getElementById('allocLegend').innerHTML =
        labels.map((l,i)=>`${l}: ${fmt(per[i])}%`).join(' â€¢ ');

      // Ù…Ø®Ø·Ø· EGX30
      if(!window.egxMounted && window.TradingView){
        new TradingView.widget({
          container_id:"egx", autosize:true, symbol:"EGX:EGX30",
          interval:"60", timezone:"Africa/Cairo", theme:"dark", style:"1",
          hide_top_toolbar:true, withdateranges:false, hide_legend:true,
          hide_volume:true, studies:[], locale:"ar"
        });
        window.egxMounted = true;
      }

      // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙˆÙ‚
      await updateMarketBar();
    }

    async function updateMarketBar(){
      try{
        const j = await fetch('data/market.json?_=' + Date.now()).then(r=>r.json());
        const set = (id, val)=>{
          const el = document.getElementById(id);
          if(!el) return;
          el.textContent = (val>=0?'+':'') + Number(val||0).toFixed(2) + '%';
          el.className = val>=0 ? 'pos' : 'neg';
        };
        set('egx30_val', j?.egx30?.chg_pct ?? 0);
        set('egx70_val', j?.egx70?.chg_pct ?? 0);
        const usd = document.getElementById('usd_val');
        if(usd) usd.textContent = Number(j?.usd_egp ?? 0).toFixed(2) + ' Ø¬';
      }catch(e){ console.warn('market.json error', e); }
    }

    renderAll();
    setInterval(renderAll, REFRESH_MS);
  </script>

  <!-- Ø³ÙƒØ±Ø¨Øª Ø²Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¹Ø¨Ø± GitHub + Ù…Ø­Ø±Ø± Ø§Ù„ÙŠÙˆÙ… -->
  <script>
  /* ========= Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª GitHub ========== */
  const GH = {
    owner:"temsah2002-arch",
    repo:"Thndr-report-temsah",
    branch:"main",
    paths:{ portfolio:"data/portfolio.json", dailylog:"data/daily_log.json" }
  };
  const b64=s=>btoa(unescape(encodeURIComponent(s)));
  const deB64=s=>decodeURIComponent(escape(atob(s)));
  function getToken(){return localStorage.getItem("gh_token")||"";}
  function setToken(t){localStorage.setItem("gh_token",t.trim());}

  async function ghRead(path){
    const url=`https://api.github.com/repos/${GH.owner}/${GH.repo}/contents/${path}?ref=${GH.branch}`;
    const r=await fetch(url,{headers:{Accept:"application/vnd.github+json"}});
    if(!r.ok)throw new Error("Read failed: "+path);
    const j=await r.json();
    return {sha:j.sha,text:deB64(j.content||"")};
  }
  async function ghWrite(path,content,sha,message){
    const token=getToken();
    if(!token)throw new Error("NO_TOKEN");
    const url=`https://api.github.com/repos/${GH.owner}/${GH.repo}/contents/${path}`;
    const body={message,content:b64(content),sha,branch:GH.branch};
    const r=await fetch(url,{
      method:"PUT",
      headers:{ "Accept":"application/vnd.github+json","Authorization":"Bearer "+token },
      body:JSON.stringify(body)
    });
    if(!r.ok)throw new Error(await r.text());
    return r.json();
  }
  function downloadFile(name,text){
    const a=document.createElement('a');
    a.href=URL.createObjectURL(new Blob([text],{type:'application/json'}));
    a.download=name;a.click();
  }

  /* ============ Ù…Ø­Ø±Ø± Ø§Ù„Ù‚ÙŠÙ… (Modal) ============ */
  const EDIT = { active:false, data:null };

  function num(v){
    if(typeof v!=='string') v = String(v??'');
    const ar = 'Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©';
    v = v.replace(/[Ù -Ù©]/g, d => ar.indexOf(d)).replace(/[^\d\.\-]/g,'');
    const n = parseFloat(v); return isFinite(n) ? n : 0;
  }
  function isoDateOrToday(v){
    // ÙŠØ¹ÙŠØ¯ YYYY-MM-DD ØµØ­ÙŠØ­Ø© Ø£Ùˆ ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ…
    const d = new Date(v||Date.now());
    const y=d.getFullYear(), m=String(d.getMonth()+1).padStart(2,'0'), dd=String(d.getDate()).padStart(2,'0');
    return `${y}-${m}-${dd}`;
  }

  async function openEditor(){
    const pf = await fetch('data/portfolio.json?_='+Date.now()).then(r=>r.json()).catch(()=>({}));
    const pos = pf.positions||[];
    const best = pos.slice().sort((a,b)=>(b.pnl_pct||0)-(a.pnl_pct||0))[0]?.ticker || '';
    const worst= pos.slice().sort((a,b)=>(a.pnl_pct||0)-(b.pnl_pct||0))[0]?.ticker || '';

    document.getElementById('ed_date').value  = isoDateOrToday(pf.as_of);
    document.getElementById('ed_val').value   = pf.portfolio_value ?? '';
    document.getElementById('ed_chg').value   = pf.day_change ?? '';
    document.getElementById('ed_pct').value   = pf.day_change_pct ?? '';
    document.getElementById('ed_best').value  = best;
    document.getElementById('ed_worst').value = worst;
    document.getElementById('ed_notes').value = '';

    document.getElementById('backdrop').classList.add('show');
    document.getElementById('editor').classList.add('show');
    EDIT.active = true;
  }
  function closeEditor(){
    document.getElementById('editor').classList.remove('show');
    document.getElementById('backdrop').classList.remove('show');
    EDIT.active = false;
  }
  function saveEditor(){
    const date  = isoDateOrToday(document.getElementById('ed_date').value);
    const val   = num(document.getElementById('ed_val').value);
    const chg   = num(document.getElementById('ed_chg').value);
    let   pctV  = document.getElementById('ed_pct').value.trim();
    let   pct   = pctV==='' ? null : num(pctV);
    if(pct===null){ pct = (val!==0) ? (chg/Math.abs(val))*100 : 0; }
    const best  = document.getElementById('ed_best').value.trim();
    const worst = document.getElementById('ed_worst').value.trim();
    const notes = document.getElementById('ed_notes').value.trim();

    EDIT.data = { date, portfolio_value: val, day_change: chg, day_change_pct: pct, best_stock: best, worst_stock: worst, notes };
    EDIT.active = false;
    closeEditor();
    alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù‚ÙŠÙ… Ù…Ø¤Ù‚ØªÙ‹Ø§. Ø§Ø¶ØºØ· "ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙŠÙˆÙ…" Ù„ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù‚ÙŠÙ… Ø¥Ù„Ù‰ JSON.');
  }

  document.getElementById('btnEdit').addEventListener('click', openEditor);
  document.getElementById('btnToken').addEventListener('click', ()=>{
    const t=prompt("Ø£Ø¯Ø®Ù„ GitHub Token (scope: repo) Ù„ÙŠÙØ­ÙØ¸ Ù…Ø­Ù„ÙŠÙ‹Ø§:");
    if(t) setToken(t);
    alert(getToken()?"ØªÙ… Ø§Ù„Ø­ÙØ¸ âœ…":"Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø­ÙØ¸.");
  });

  async function doUpdate(){
    const pf=await fetch('data/portfolio.json?_='+Date.now()).then(r=>r.json());
    const logObj=await fetch('data/daily_log.json?_='+Date.now()).then(r=>r.json());

    // Ø§Ø³ØªØ®Ø¯Ù… Ù‚ÙŠÙ… Ø§Ù„Ù…Ø­Ø±Ø± (Ø¥Ù† ÙˆÙØ¬Ø¯Øª) ÙˆØ¥Ù„Ø§ Ø§ØªØ±Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©
    const sessionDate = EDIT.data?.date || isoDateOrToday(pf.as_of);
    if(EDIT.data){
      pf.as_of           = sessionDate;
      pf.portfolio_value = EDIT.data.portfolio_value;
      pf.day_change      = EDIT.data.day_change;
      pf.day_change_pct  = EDIT.data.day_change_pct;
    }

    // Ø­Ø³Ø§Ø¨ Ø£ÙØ¶Ù„/Ø£Ø³ÙˆØ£
    const pos = pf.positions||[];
    const autoBest  = pos.slice().sort((a,b)=>(b.pnl_pct||0)-(a.pnl_pct||0))[0]?.ticker || '';
    const autoWorst = pos.slice().sort((a,b)=>(a.pnl_pct||0)-(b.pnl_pct||0))[0]?.ticker || '';
    const best  = (EDIT.data?.best_stock  || autoBest);
    const worst = (EDIT.data?.worst_stock || autoWorst);

    const entry = {
      date: sessionDate,
      portfolio_value: +pf.portfolio_value||0,
      day_change: +pf.day_change||0,
      day_change_pct: +pf.day_change_pct||0,
      best_stock: best,
      worst_stock: worst,
      notes: (EDIT.data?.notes || "ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…Ù† Ù„ÙˆØ­Ø© Thndr.")
    };

    // Ø­Ø¯Ù‘Ø« entries (Ø§Ø³ØªØ¨Ø¯Ø§Ù„ ÙŠÙˆÙ… Ù…ÙˆØ¬ÙˆØ¯ Ø£Ùˆ Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙŠØ¯)
    const entries = Array.isArray(logObj.entries) ? logObj.entries : [];
    const idx = entries.findIndex(e => e.date === sessionDate);
    if(idx>=0) entries[idx] = entry; else entries.push(entry);

    const newLog = JSON.stringify({as_of: sessionDate, entries}, null, 2);
    const newPf  = JSON.stringify(pf, null, 2);

    try{
      const pr=await ghRead(GH.paths.portfolio);
      const lr=await ghRead(GH.paths.dailylog);
      await ghWrite(GH.paths.portfolio,newPf,pr.sha,`update portfolio ${sessionDate}`);
      await ghWrite(GH.paths.dailylog,newLog,lr.sha,`upsert daily_log ${sessionDate}`);
      alert('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„ÙÙŠÙ† Ø¹Ù„Ù‰ GitHub');
      location.reload();
    }catch(e){
      if(e.message.includes("NO_TOKEN")) alert("âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Token â€” Ø³ÙŠØªÙ… ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„ÙÙŠÙ† ÙŠØ¯ÙˆÙŠÙ‹Ø§.");
      else alert("âš ï¸ ØªØ¹Ø°Ù‘Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¹Ù„Ù‰ GitHub â€” Ø³ÙŠØªÙ… ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„ÙÙŠÙ† Ù…Ø­Ù„ÙŠÙ‹Ø§.");
      downloadFile('portfolio.json', newPf);
      downloadFile('daily_log.json', newLog);
    }
  }
  document.getElementById('btnUpdate').addEventListener('click', doUpdate);
  </script>

  <!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ØªØ­Ø±ÙŠØ± -->
  <div id="backdrop" class="modal-backdrop"></div>
  <div id="editor" class="modal">
    <div class="box">
      <h3 style="margin:0 0 8px">ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ù„Ø³Ø© Ø§Ù„ÙŠÙˆÙ…</h3>

      <div class="row">
        <div style="flex:1 1 180px">
          <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¬Ù„Ø³Ø© (YYYY-MM-DD)</label>
          <input id="ed_date" type="date" inputmode="none" placeholder="2025-11-05">
        </div>
        <div style="flex:1 1 180px">
          <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø© (portfolio_value)</label>
          <input id="ed_val" type="text" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 7850.49">
        </div>
        <div style="flex:1 1 180px">
          <label>ØªØºÙŠØ± Ø§Ù„ÙŠÙˆÙ… (day_change)</label>
          <input id="ed_chg" type="text" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: -17.67">
        </div>
      </div>

      <div class="row">
        <div style="flex:1 1 180px">
          <label>Ù†Ø³Ø¨Ø© Ø§Ù„ØªØºÙŠØ± % (day_change_pct)</label>
          <input id="ed_pct" type="text" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: -0.22">
        </div>
        <div style="flex:1 1 180px">
          <label>Ø£ÙØ¶Ù„ Ø³Ù‡Ù… (best_stock)</label>
          <input id="ed_best" type="text" placeholder="COMI">
        </div>
        <div style="flex:1 1 180px">
          <label>Ø£Ø¶Ø¹Ù Ø³Ù‡Ù… (worst_stock)</label>
          <input id="ed_worst" type="text" placeholder="BSB">
        </div>
      </div>

      <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª (notes)</label>
      <textarea id="ed_notes" rows="3" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø©â€¦"></textarea>

      <div class="actions">
        <button class="btn btn--soft" id="ed_cancel" onclick="(function(){document.getElementById('editor').classList.remove('show');document.getElementById('backdrop').classList.remove('show')})();">Ø¥Ù„ØºØ§Ø¡</button>
        <button class="btn" id="ed_save" onclick="(function(){const e=new Event('click');saveEditor();})();">Ø­ÙØ¸ Ø§Ù„Ù‚ÙŠÙ…</button>
      </div>
    </div>
  </div>

  <script>
    // Ø±Ø¨Ø· Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ (Ø¨Ø¹Ø¯ Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¹Ù†Ø§ØµØ±)
    function saveEditor(){ /* Ù‡Ø°Ù‡ ØªÙØ¹Ø±Ù‘Ù ÙÙŠ Ø³ÙƒØ±Ø¨Øª GitHub Ø£Ø¹Ù„Ø§Ù‡ */ }
    // Ù†Ø¹ÙŠØ¯ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø±Ø¨Ø· Ø§Ù„ØµØ­ÙŠØ­ Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    window.addEventListener('DOMContentLoaded', ()=>{
      // Ø±Ø¨Ø· Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ù…Ù† Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø¹Ø±Ù‘ÙØ© Ø£Ø¹Ù„Ø§Ù‡
      document.getElementById('ed_save').onclick = function(){ saveEditor(); };
      document.getElementById('ed_cancel').onclick = function(){
        document.getElementById('editor').classList.remove('show');
        document.getElementById('backdrop').classList.remove('show');
      };
    });
  </script>
</body>
</html>
